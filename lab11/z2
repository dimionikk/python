import pandas as pd
import matplotlib.pyplot as plt

# Завантаження CSV у DataFrame
df = pd.read_csv('cv.csv', parse_dates=['Date'], dayfirst=True)

# Перевірка основних характеристик
print(df.head())
print(df.info())
print(df.describe())

# Заповнюємо пропущені значення нулями
df[['Berri1', 'Maisonneuve_1', 'Maisonneuve_2', 'Brébeuf']] = df[['Berri1', 'Maisonneuve_1', 'Maisonneuve_2', 'Brébeuf']].fillna(0)

# Загальна кількість велосипедистів за рік на всіх велодоріжках
total_all_paths = df[['Berri1', 'Maisonneuve_1', 'Maisonneuve_2', 'Brébeuf']].sum().sum()
print("Загальна кількість велосипедистів за рік на всіх велодоріжках:", int(total_all_paths))

# Загальна кількість велосипедистів за рік на кожній велодоріжці
total_per_path = df[['Berri1', 'Maisonneuve_1', 'Maisonneuve_2', 'Brébeuf']].sum()
print("Загальна кількість велосипедистів за рік на кожній велодоріжці:\n", total_per_path.astype(int))

# Додаємо колонку місяця
df['Month'] = df['Date'].dt.month

# Вибираємо три велодоріжки для аналізу
paths = ['Berri1', 'Maisonneuve_1', 'Maisonneuve_2']

# Найбільш популярний місяць на кожній з трьох велодоріжок
for path in paths:
    monthly_sum = df.groupby('Month')[path].sum()
    popular_month = monthly_sum.idxmax()
    print(f"Найбільш популярний місяць для {path}: {popular_month} ({int(monthly_sum.max())} велосипедистів)")

# Графік завантаженості однієї велодоріжки по місяцях
monthly_berri1 = df.groupby('Month')['Berri1'].sum()
plt.figure(figsize=(8,5))
monthly_berri1.plot(kind='bar', color='skyblue')
plt.title('Завантаженість велодоріжки Berri1 по місяцях')
plt.xlabel('Місяць')
plt.ylabel('Кількість велосипедистів')
plt.xticks(rotation=0)
plt.show()
